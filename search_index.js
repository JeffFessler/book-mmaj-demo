var documenterSearchIndex = {"docs":
[{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/04/ls-fit1.jl\"","category":"page"},{"location":"generated/demos/04/ls-fit1/#ls-fit1","page":"LS fitting","title":"LS fitting","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"This example illustrates least squares (LS) polynomial fitting using the Julia language.","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"This entire page was generated using a single Julia file: ls-fit1.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"The corresponding notebook can be viewed in nbviewer here: ls-fit1.ipynb, and opened in binder here: ls-fit1.ipynb,","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"Plots\"\n        \"LaTeXStrings\"\n        \"MIRTjim\"\n        \"Random\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"using LinearAlgebra: Diagonal, svd\nusing Random: seed!\nusing Plots; default(label=\"\", markerstrokecolor=:auto)\n#using LaTeXStrings\nusing MIRTjim: prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"isinteractive() && prompt(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/04/ls-fit1/#Simulated-data-from-latent-nonlinear-function","page":"LS fitting","title":"Simulated data from latent nonlinear function","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"s = (t) -> atan(4*(t-0.5)) # nonlinear function\n\nseed!(1) # seed rng\nM = 15 # how many data points\ntm = sort(rand(M)) # M random sample locations\ny = s.(tm) + 0.1 * randn(M) # noisy samples\n\nt0 = LinRange(0, 1, 101) # fine sampling for showing curve\np0 = scatter(tm, y, color=:blue,\n    label=\"y (noisy data)\", xlabel=\"t\", ylabel=\"y\", ylim=(-1.3, 1.3))\nplot!(t0, s.(t0), color=:blue, label=\"s(t) : latent signal\", legend=:topleft)","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-fit1/#Polynomial-fitting","page":"LS fitting","title":"Polynomial fitting","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"deg = 3 # polynomial degree\nAfun = (tt) -> [t.^i for t in tt, i in 0:deg] # matrix of monomials\nA = Afun(tm) # M × 4 matrix\np1 = plot(title=\"Columns of matrix A\", xlabel=\"t\", legend=:left)\nfor i in 0:deg\n    plot!(p1, tm, A[:,i+1], marker=:circle, label = \"A[:,$(i+1)]\")\nend","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-fit1/#Fit-4-unknowns-with-4-equations","page":"LS fitting","title":"Fit 4 unknowns with 4 equations","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"m4 = Int64.(round.(LinRange(1, M-1, 4))) # pick 4 points well separated\nA4 = A[m4,:] # 4 × 4 matrix\nx4 = inv(A4) * y[m4] # inverse of 4×4 matrix to solve \"y = A x\"\n\nscatter!(p0, tm[m4], y[m4], marker=:circle, color=:red)\nplot!(p0, t0, Afun(t0)*x4, color=:red, label=\"Fit using 4 of $M points\")","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-fit1/#Fit-4-unknowns-using-all-M15-equations","page":"LS fitting","title":"Fit 4 unknowns using all M=15 equations","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"xh = A \\ y # backslash for LS solution using all M samples\n\nplot!(p0, t0, Afun(t0)*xh, color=:green, label=\"Fit cubic using all M=$(M) points\")","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-fit1/#SVD-solution","page":"LS fitting","title":"SVD solution","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"U, s, V = svd(A)\ns","category":"page"},{"location":"generated/demos/04/ls-fit1/#Verify-equivalence-of-SVD-and-backslash-solutions-to-LS-problem","page":"LS fitting","title":"Verify equivalence of SVD and backslash solutions to LS problem","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"xh2 = V * Diagonal(1 ./ s) * (U' * y) # SVD-based solution\nxh3 = V * ( (1 ./ s) .* (U' * y) ) # mathematically equivalent alternate expression\n\n@assert xh ≈ xh2\n@assert xh ≈ xh3","category":"page"},{"location":"generated/demos/04/ls-fit1/#Reproducibility","page":"LS fitting","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"And with the following package versions","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"","category":"page"},{"location":"generated/demos/04/ls-fit1/","page":"LS fitting","title":"LS fitting","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/03/svd-diff.jl\"","category":"page"},{"location":"generated/demos/03/svd-diff/#svd-diff","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"This example illustrates the SVD of a first-order finite-difference matrix using the Julia language. This demo was inspired by Gilbert Strang's 2006 article.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"This entire page was generated using a single Julia file: svd-diff.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"The corresponding notebook can be viewed in nbviewer here: svd-diff.ipynb, and opened in binder here: svd-diff.ipynb,","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"Plots\"\n        \"LaTeXStrings\"\n        \"MIRTjim\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"using LinearAlgebra: norm, I, diag, diagm, Diagonal\nusing Plots; default(label=\"\", markerstrokecolor=:auto, color=:blue)\n#using LaTeXStrings\nusing MIRTjim: jim, prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"isinteractive() && jim(:prompt, true);\nnothing #hide","category":"page"},{"location":"generated/demos/03/svd-diff/#First-order-finite-difference-matrix","page":"SVD of Finite Differences","title":"First-order finite-difference matrix","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"N = 16\nΔ = diagm(0 => -ones(Int,N-1), 1 => ones(Int,N-1))[1:(N-1),:] # (N-1,N) diff\njim(Δ'; title=\"$(N-1) × $N finite-difference matrix Δ\", color=:cividis)","category":"page"},{"location":"generated/demos/03/svd-diff/#Left-singular-vectors-are-cos-functions","page":"SVD of Finite Differences","title":"Left singular vectors are cos functions","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"h = π / N\nv = k -> cos.(((1:N)*2 .- 1) * k * h / 2) / sqrt(N/2)\n\nplot(v(5), line=:stem, marker=:circle, title=\"5th left singular vector\",\n xtick=1:N, ylims=(-0.5,0.5), yticks=(-1:1)*0.5)","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"prompt()","category":"page"},{"location":"generated/demos/03/svd-diff/#Right-singular-vectors-are-sin-functions","page":"SVD of Finite Differences","title":"Right singular vectors are -sin functions","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"u = k -> -sin.((1:(N-1)) * k * h) / sqrt(N/2) # \"derivative of cos is -sin\"\n\nplot(u(5), line=:stem, marker=:circle, title=\"5th right singular vector\",\n xtick=1:N, ylims=(-0.5,0.5), yticks=(-1:1)*0.5)","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"prompt()","category":"page"},{"location":"generated/demos/03/svd-diff/#Singular-values","page":"SVD of Finite Differences","title":"Singular values","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/#(Caution:-not-in-descending-order)","page":"SVD of Finite Differences","title":"(Caution: not in descending order)","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"σ = k -> 2*sin(k*h/2)\nk = 1:(N-1)\n\nscatter(k, σ.(k), title=\"$(N-1) singular values (unordered)\",\n color=:red, xtick=1:N, ylims=(0,2), yticks=0:2, ywiden=true)","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"prompt()","category":"page"},{"location":"generated/demos/03/svd-diff/#SVD-components","page":"SVD of Finite Differences","title":"SVD components","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"V = hcat([v(k) for k in 1:(N-1)]...) # (N,N-1) \"V_{N-1}\" DCT\nU = hcat([u(k) for k in 1:(N-1)]...) # (N-1,N-1) DST\nΣ = Diagonal(σ.(1:(N-1))) # (N-1,N_1) Σ_N\n\njim(\n jim(V', \"U: Left singular vectors\"; color=:cividis),\n jim(U', \"V: Right singular vectors\"; color=:cividis),\n jim(Σ', \"Σ: Singular values\"; color=:cividis),\n)","category":"page"},{"location":"generated/demos/03/svd-diff/#Verify-correctness-of-SVD","page":"SVD of Finite Differences","title":"Verify correctness of SVD","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"@assert all(>(0), diag(Σ)) # singular values are nonnegative\n@assert Δ * V ≈ U * Σ # \"derivative of cos is -sin\"\n@assert V'V ≈ I(N-1) # V is semi-unitary\n@assert U'U ≈ I(N-1) && U*U' ≈ I(N-1) # U is unitary\n@assert Δ ≈ U * Σ * V' # SVD of Δ","category":"page"},{"location":"generated/demos/03/svd-diff/#Reproducibility","page":"SVD of Finite Differences","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"And with the following package versions","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"","category":"page"},{"location":"generated/demos/03/svd-diff/","page":"SVD of Finite Differences","title":"SVD of Finite Differences","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/06/lr-sure.jl\"","category":"page"},{"location":"generated/demos/06/lr-sure/#lr-sure","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"This example illustrates Stein's unbiased risk estimation (SURE) for parameter selection in low-rank matrix approximation, using the Julia language.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"This entire page was generated using a single Julia file: lr-sure.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"The corresponding notebook can be viewed in nbviewer here: lr-sure.ipynb, and opened in binder here: lr-sure.ipynb,","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"MIRTjim\"\n        \"Plots\"\n        \"Random\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"using LinearAlgebra: svd, svdvals, Diagonal, norm\nusing Random: seed!\nusing Plots; default(label=\"\", markerstrokecolor=:auto, markersize=7,\n guidefontsize=13, tickfontsize=12, legendfontsize=13, widen=true)\nusing LaTeXStrings\nusing MIRTjim: prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"isinteractive() && prompt(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/06/lr-sure/#Generate-data","page":"Low-Rank SURE","title":"Generate data","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"Noiseless low-rank matrix and noisy data matrix","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"M, N = 100, 50 # problem size\nseed!(0)\nKtrue = 5 # true rank (planted model)\nX = svd(randn(M,Ktrue)).U * Diagonal(1:Ktrue) * svd(randn(Ktrue,N)).Vt\nsig0 = 0.03 # noise standard deviation\nY = X + sig0 * randn(size(X)) # noisy\nsy = svdvals(Y)\nsx = svdvals(X)\nsx[1:Ktrue]","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"sy[1:Ktrue]","category":"page"},{"location":"generated/demos/06/lr-sure/#Plot-singular-values","page":"Low-Rank SURE","title":"Plot singular values","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"plot(xlabel=L\"k\", ylabel=L\"\\sigma\")\nscatter!(1:N, sy, color=:blue, label=L\"\\sigma_k(Y) \\ \\mathrm{noisy}\")\nscatter!(1:N, sx, color=:red, label=L\"\\sigma_k(X) \\ \\mathrm{noiseless}\")\nplot!(xtick=[1, Ktrue, N], ytick=0:5, xlim=(1,N), ylim=(0, 5.5))","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"prompt()","category":"page"},{"location":"generated/demos/06/lr-sure/#Low-rank-approximation-with-various-ranks","page":"Low-Rank SURE","title":"Low-rank approximation with various ranks","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"(U, sy, V) = svd(Y)\nnrmse_K = zeros(N)\nnrmsd_K = zeros(N)\nnrmsd = (D) -> norm(D) / norm(Y) * 100\nnrmse = (D) -> norm(D) / norm(X) * 100\nfor K=1:N\n    Xh = U[:,1:K] * Diagonal(sy[1:K]) * V[:,1:K]'\n    nrmsd_K[K] = nrmsd(Xh - Y)\n    nrmse_K[K] = nrmse(Xh - X)\nend\nnrmsd_K = [nrmsd(0 .- Y); nrmsd_K]\nnrmse_K = [nrmse(0 .- X); nrmse_K]\nklist = 0:N;\nnothing #hide","category":"page"},{"location":"generated/demos/06/lr-sure/#Plot-normalized-root-mean-squared-error/difference-versus-rank-K","page":"Low-Rank SURE","title":"Plot normalized root mean-squared error/difference versus rank K","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"plot(xtick=[0, 2, Ktrue, N], ytick=0:20:100,\n    xlabel=L\"K\", ylabel=\"'Error' [%]\", xlim=(1,N), ylim=(0, 100))\nscatter!(klist, nrmse_K, color=:blue,\n    label=L\"\\mathrm{NRMSE\\ } \\|\\hat{X}_K - X\\|_F / \\|X\\|_F \\cdot 100\\%\")\nscatter!(klist, nrmsd_K, color=:red,\n    label=L\"\\mathrm{NRMSD\\ } \\|\\hat{X}_K - Y\\|_F / \\|Y\\|_F \\cdot 100\\%\")","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"prompt()","category":"page"},{"location":"generated/demos/06/lr-sure/#Explore-(nuclear-norm)-regularized-version","page":"Low-Rank SURE","title":"Explore (nuclear norm) regularized version","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"soft = (s,β) -> max.(s-β,0) # soft threshold function\ndsoft = (s,β) -> Float32.(s .> β) # \"derivative\" thereof\nreglist = [LinRange(0, 1, 20); 1:0.25:6]\nNr = length(reglist)\nnrmse_reg = zeros(Nr)\nnrmsd_reg = zeros(Nr)\nfor ir=1:Nr\n    reg = reglist[ir]\n    Xh = U * Diagonal(soft.(sy,reg)) * V'\n    nrmsd_reg[ir] = nrmsd(Xh - Y)\n    nrmse_reg[ir] = nrmse(Xh - X)\nend;\nnothing #hide","category":"page"},{"location":"generated/demos/06/lr-sure/#Plot-NRMSE-and-NRMSD-versus-regularization-parameter","page":"Low-Rank SURE","title":"Plot NRMSE and NRMSD versus regularization parameter","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"plot(xtick=0:6, ytick=0:20:100, legend=:bottomright,\n    xlabel=L\"\\beta\", ylabel=\"'Error' [%]\", xlim=(0,6), ylim=(0, 100))\nscatter!(reglist, nrmse_reg, color=:blue,\n    label=L\"\\mathrm{NRMSE\\ } \\|\\hat{X}_{\\beta} - X\\|_F / \\|X\\|_F \\cdot 100\\%\")\nscatter!(reglist, nrmsd_reg, color=:red,\n    label=L\"\\mathrm{NRMSD\\ } \\|\\hat{X}_{\\beta} - Y\\|_F / \\|Y\\|_F \\cdot 100\\%\")","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"prompt()","category":"page"},{"location":"generated/demos/06/lr-sure/#Explore-SURE-for-selecting-\\beta","page":"Low-Rank SURE","title":"Explore SURE for selecting beta","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"SURE","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"(\\beta) = \\Vert \\hat{X} - Y \\Vert^2 - MN \\sigma0^2 + 2 \\sigma0^2 \\left( |M - N| \\sum{i=1}^{\\min(M,N)} \\frac{h(\\sigmai;\\beta)}{\\sigmai} + \\sum{i=1}^{\\min(M,N)} \\dot{h}i(\\sigmai;\\beta) + 2 \\sum{i \\neq j}^{\\min(M,N)} \\frac{\\sigmai hi(\\sigmai;\\beta)}{\\sigmai^2 - \\sigmaj^2} \\right) $","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"sy: singular values of Y reg: regularization parameter v0 = sigma_0^2 noise variance","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"function sure(sy, reg, v0, M, N)\n    sh = soft.(sy, reg) # estimated singular values\n    big = sy.^2 .- (sy.^2)'\n    big[big .== 0] .= Inf # trick to avoid divide by 0\n    big = (sy .* sh) ./ big # [sy[i] * sh[i] / big[i,j] for i=1:N, j=1:N]\n    big = sum(big)\n    norm(sh - sy)^2 - M*N*v0 + 2*v0*(abs(M-N)*sum(sh ./ sy) + sum(dsoft.(sy,reg)) + 2*big)\nend","category":"page"},{"location":"generated/demos/06/lr-sure/#Evaluate-SURE-for-each-candidate-regularization-parameter","page":"Low-Rank SURE","title":"Evaluate SURE for each candidate regularization parameter","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"sure_reg = [sure(sy, reglist[ir], sig0^2, M, N) for ir=1:Nr]\nreg_best = reglist[argmin(sure_reg)] # SURE pick for β","category":"page"},{"location":"generated/demos/06/lr-sure/#Plot-NRMSE-and-NRMSD-versus-regularization-parameter-2","page":"Low-Rank SURE","title":"Plot NRMSE and NRMSD versus regularization parameter","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"plot(xtick=[round(reg_best,digits=3), 6], ytick=0:20:100, legend=:bottomright,\n    xlabel=L\"\\beta\", ylabel=\"'Error' [%]\", xlim=(0,6), ylim=(0, 100))\nscatter!(reglist, nrmse_reg, color=:blue,\n    label=L\"\\mathrm{NRMSE\\ } \\|\\hat{X}_\\beta - X\\|_F / \\|X\\|_F \\cdot 100\\%\",)\nscatter!(reglist, nrmsd_reg, color=:red,\n    label=L\"\\mathrm{NRMSD\\ } \\|\\hat{X}_\\beta - Y\\|_F / \\|Y\\|_F \\cdot 100\\%\")\nscatter!(reglist, sqrt.(sure_reg)/norm(Y)*100, color=:green,\n    label=L\"(\\mathrm{SURE}(\\beta))^{1/2} / \\|Y\\|_F \\cdot 100\\%\")","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"prompt()","category":"page"},{"location":"generated/demos/06/lr-sure/#Examine-shrunk-singular-values-for-best-regularization-parameter","page":"Low-Rank SURE","title":"Examine shrunk singular values for best regularization parameter","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"sh = soft.(sy,reg_best)\nplot(xtick=[1, Ktrue, sum(sh .!= 0), N], ytick=0:6,\n    xlabel=L\"k\", ylabel=L\"\\sigma\", xlim=(1,N), ylim=(0,5.5))\nscatter!(1:N, sy, color=:blue, label=L\"\\sigma_k(Y) \\ \\mathrm{noisy}\")\nscatter!(1:N, sx, color=:red, label=L\"\\sigma_k(X) \\ \\mathrm{noiseless}\")\nscatter!(1:N, sh, color=:green, label=L\"\\hat{\\sigma}_k \\ \\mathrm{SURE} \\ \\hat{\\beta}\")","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"prompt()","category":"page"},{"location":"generated/demos/06/lr-sure/#Reproducibility","page":"Low-Rank SURE","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"And with the following package versions","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"","category":"page"},{"location":"generated/demos/06/lr-sure/","page":"Low-Rank SURE","title":"Low-Rank SURE","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/06/source-local.jl\"","category":"page"},{"location":"generated/demos/06/source-local/#source-local","page":"Source localization approximation","title":"Source localization approximation","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"This example illustrates source localization via multi-dimensional scaling using the Julia language.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"This entire page was generated using a single Julia file: source-local.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"The corresponding notebook can be viewed in nbviewer here: source-local.ipynb, and opened in binder here: source-local.ipynb,","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"MIRTjim\"\n        \"Plots\"\n        \"Random\"\n        \"Statistics\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"using LinearAlgebra: svd, norm, Diagonal\nusing Statistics: mean\nusing Random: seed!\nusing Plots; default(label=\"\", markerstrokecolor=:auto)\nusing MIRTjim: jim, prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"isinteractive() && prompt(:prompt);\nisinteractive() && jim(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/06/source-local/#Generate-data","page":"Source localization approximation","title":"Generate data","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Coordinates - can you identify the pattern?  probably not...","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"C0 = [\n3 2.5 2 2 2 2 2 1 0 0 1 1 1 1 0 0 1 2 2.5 3  4 4.5 5 6 7 7 6 6 6 6 7 7 6 5 5 5 5 5 4.5 4;\n2 3.0 4 3 2 1 0 0 0 1 1 2 3 4 4 5 5 5 4.0 3  3 4.0 5 5 5 4 4 3 2 1 1 0 0 0 1 2 3 4 3.0 2\n];\nnothing #hide","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Interpolate the locations to make the final set more familiar","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"C2 = (C0[:,2:end] + C0[:,1:end-1])/2\nCe = (C0[:,1] + C0[:,end])/2\nC3 = [C2 Ce]\nC4 = [C0; C3]\nC = reshape(C4, 2, :);\nnothing #hide","category":"page"},{"location":"generated/demos/06/source-local/#Compute-J-J-distance-array-and-display-it","page":"Source localization approximation","title":"Compute J × J distance array and display it","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"J = size(C,2) # number of points\nD = [norm(C[:,j] - C[:,i]) for i=1:J, j=1:J] # \"comprehension\" in julia!\njim(D, \"D\", color=:cividis)","category":"page"},{"location":"generated/demos/06/source-local/#MDS-algorithm","page":"Source localization approximation","title":"MDS algorithm","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Compute Gram matrix by de-meaning squared distance matrix","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"S = D.^2 # squared distances\nG = S .- mean(S,dims=1) # trick: use \"broadcasting\" feature of julia\nG = G .- mean(G,dims=2) # now we have de-meaned the columns and rows of S\nG = -1/2 * G\njim(G, \"G\", color=:cividis) # still cannot determine visually the point locations","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Examine singular values","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"(_, σ, V) = svd(G) # svd returns singular values in descending order\nscatter(σ, label=\"singular values\") # two nonzero (d=2)","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/source-local/#Estimate-the-source-locations-using-rank2","page":"Source localization approximation","title":"Estimate the source locations using rank=2","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Ch = Diagonal(sqrt.(σ[1:2])) * V[:,1:2]' # here is the key step","category":"page"},{"location":"generated/demos/06/source-local/#Plot-estimated-source-locations","page":"Source localization approximation","title":"Plot estimated source locations","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"scatter(Ch[1,:], -Ch[2,:], xtick=-4:4, ytick=-3:3, label=\"\", aspect_ratio=1,\n title=\"Location estimates\")","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/source-local/#Noisy-case","page":"Source localization approximation","title":"Noisy case","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"seed!(0)\nDn = D + 0.3 * randn(size(D))\nSn = Dn.^2\nGn = Sn .- mean(Sn,dims=1)\nGn = Gn .- mean(Gn,dims=2) # de-meaned\nGn = -1/2 * Gn\njim(Gn, \"G noisy\", color=:cividis) # still cannot determine visually the point locations","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Singular values","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"(_, sn, Vn) = svd(Gn)\nscatter(abs.(sn), label=\"singular values\") # two >> 0","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/source-local/#Plot-estimated-source-locations-from-noisy-distance-measurements","page":"Source localization approximation","title":"Plot estimated source locations from noisy distance measurements","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"Cn = Diagonal(sqrt.(sn[1:2])) * Vn[:,1:2]' # here is the key step\nscatter(Cn[1,:], -Cn[2,:], xtick=-4:4, ytick=-3:3, label=\"\", aspect_ratio=1,\n title=\"Location estimates\")","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/source-local/#Equilateral-triangle-example","page":"Source localization approximation","title":"Equilateral triangle example","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"G = [-2 1 1; 1 -2 1; 1 1 -2] / (-6.)\n(~, σ, V) = svd(G)\nCh = Diagonal(sqrt.(σ[1:2])) * V[:,1:2]'\nscatter(Ch[1,:], Ch[2,:], aspect_ratio=1, label=\"\",\n title=\"Location estimates\")","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/source-local/#Reproducibility","page":"Source localization approximation","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"And with the following package versions","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"","category":"page"},{"location":"generated/demos/06/source-local/","page":"Source localization approximation","title":"Source localization approximation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/06/rank1.jl\"","category":"page"},{"location":"generated/demos/06/rank1/#rank-1","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"This example illustrates rank-1 approximations using the Julia language.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"This entire page was generated using a single Julia file: rank1.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"The corresponding notebook can be viewed in nbviewer here: rank1.ipynb, and opened in binder here: rank1.ipynb,","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"Plots\"\n        \"Random\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"using LinearAlgebra: svd, rank\nusing Random: seed!\nusing Plots; default(label=\"\", markerstrokecolor=:auto)\nusing MIRTjim: prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"isinteractive() && prompt(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/06/rank1/#Generate-data","page":"Rank-1 approximation","title":"Generate data","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"Noisy data with slope=1.  Both x and y values are noisy!","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"seed!(0)\nx0 = 1:8 # true x locations\nx = x0 + 2*randn(size(x0)) # called \"errors in variables\"\ny = x0 + 2*randn(size(x0)); # noisy samples\nnothing #hide","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"Plotting utility function","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"lineplot = (p, s, c, l; w=3, t=:dash) ->\n    plot!(p, 0:10, (0:10)*s, line=(c,t), label=l, width=w)\nfunction plotdata()\n    p = scatter(x, y, label=\"data\", legend=:bottomright,\n        color=:blue, markersize=7,\n        aspect_ratio=:equal, xtick=0:4:8, ytick=0:4:8,\n        xlabel=\"x\", ylabel=\"y\", xlim=(0,10), ylim=(0,10))\n    lineplot(p, 1, :red, \"true\", t=:solid, w=2)\nend\npl = plotdata()","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/rank1/#Rank-1-approximation","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"To make a low-rank approximation, collect data into a matrix","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"A = [x'; y']","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"Examine singular values","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"U, s, V = svd(A)\ns # 2nd singular value is much smaller than 1st","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"Construct rank-1 approximation","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"B = U[:,1] * s[1] * V[:,1]' # rank-1 approximation\nrank(B)","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"B","category":"page"},{"location":"generated/demos/06/rank1/#Plot-rank-1-approximation","page":"Rank-1 approximation","title":"Plot rank-1 approximation","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"xb = B[1,:]\nyb = B[2,:]\n\nlineplot(pl, (xb\\yb)[1], :black, \"\")\nscatter!(pl, xb, yb, color=:black, markersize=5, marker=:square, label=\"rank1\")","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/rank1/#Now-instead-use-least-squares-estimation-to-estimate-slope:","page":"Rank-1 approximation","title":"Now instead use least-squares estimation to estimate slope:","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"slope = y'*x / (x'*x) # cf inv(A'A) * A'b\nslope = (x \\ y)[1] # cf A \\ b","category":"page"},{"location":"generated/demos/06/rank1/#Plot-the-LS-fit-and-the-low-rank-approximation-on-same-graph","page":"Rank-1 approximation","title":"Plot the LS fit and the low-rank approximation on same graph","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"lineplot(pl, slope, :green, \"LS\")","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/rank1/#Illustrate-the-Frobenius-norm-approximation-error-graphically","page":"Rank-1 approximation","title":"Illustrate the Frobenius norm approximation error graphically","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"pl = plotdata()\nfor i in 1:length(xb)\n    plot!(pl, [x[i], xb[i]], [y[i], yb[i]], color=:black, label=\"\", width=2)\nend\nlineplot(pl, (xb\\yb)[1], :black, \"\")\nscatter!(pl, xb, yb, color=:black, markersize=5, marker=:square, label=\"rank1\")","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/rank1/#Illustrate-the-LS-residual-graphically","page":"Rank-1 approximation","title":"Illustrate the LS residual graphically","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"xl = x; yl = slope*xl # LS points\npl = plotdata()\nfor i in 1:length(x)\n    plot!(pl, [x[i], xl[i]], [y[i], yl[i]], color=:green, label=\"\", width=2)\nend\nlineplot(pl, slope, :green, \"\")\nscatter!(pl, xl, yl, color=:green, markersize=5, marker=:square, label=\"LS\")","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"prompt()","category":"page"},{"location":"generated/demos/06/rank1/#Reproducibility","page":"Rank-1 approximation","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"And with the following package versions","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"","category":"page"},{"location":"generated/demos/06/rank1/","page":"Rank-1 approximation","title":"Rank-1 approximation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/04/ls-cost1.jl\"","category":"page"},{"location":"generated/demos/04/ls-cost1/#ls-cost1","page":"LS cost functions","title":"LS cost functions","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"This example illustrates linear least-squares (LS) cost functions and minimum-norm LS (MNLS) solutions using the Julia language.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"This entire page was generated using a single Julia file: ls-cost1.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"The corresponding notebook can be viewed in nbviewer here: ls-cost1.ipynb, and opened in binder here: ls-cost1.ipynb,","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"Plots\"\n        \"LaTeXStrings\"\n        \"MIRTjim\"\n        \"Random\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"using LinearAlgebra: norm, pinv\nusing Random: seed!\nusing Plots; default(label=\"\", markerstrokecolor=:auto, markersize=6, legendfontsize=12, guidefontsize=13, tickfontsize=10)\nusing LaTeXStrings\nusing MIRTjim: prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"isinteractive() && prompt(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/04/ls-cost1/#Under-determined-case","page":"LS cost functions","title":"Under-determined case","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"A = [1 2] # 1st case: M < N\ny = [3] # obviously x=[1 1] is one possible solution (but not MNLS)\nf1(x) = norm(A*x - y)\nxh1 = A \\ y\n\nx1 = LinRange(-1,1,101) * 3\nx2 = LinRange(-1,1,103) * 3\nc1 = [f1([x1a, x2a]) for x1a=x1, x2a=x2];\n\ncolor = :viridis\ncontour(x1, x2, c1', label=\"contours\"; color)\nplot!(aspect_ratio=:equal, xlabel=L\"x_1\", ylabel=L\"x_2\", legend=:bottomleft)\nscatter!([0], [0], color=:black, markershape=:square, label=\"\")\nplot!([0, xh1[1]], [0, xh1[2]], line=:magenta, label=\"\")\nplot!(x1, (y[1] .- A[1,1]*x1)/A[1,2], line=(:blue,:dash), label=\"{x : y=Ax}\")\nscatter!([1], [1], color=:blue, markershape=:star5, label=\"[1,1]\")\nscatter!([xh1[1]], [xh1[2]], color=:red, markershape=:circle, label=\"MNLS\",\n title = \"Under-determined case\")","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-cost1/#Square-but-singular-case","page":"LS cost functions","title":"Square but singular case","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"A = [1 2; 2 4] # 2nd case: M = N but singular A\ny = [3, 6] # again [1,1] is a solution (but not MNLS solution)\nf2(x) = norm(A*x - y)\nxh2 = pinv(A) * y\n\nc2 = [f2([x1a, x2a]) for x1a=x1, x2a=x2]\ncontour(x1, x2, c2', label=\"contours\"; color)\nplot!(aspect_ratio=:equal, xlabel=L\"x_1\", ylabel=L\"x_2\", legend=:bottomleft)\nscatter!([0], [0], color=:black, markershape=:square, label=\"\")\nplot!([0, xh2[1]], [0, xh2[2]], line=:magenta, label=\"\")\nplot!(x1, (y[1] .- A[1,1]*x1)/A[1,2], line=(:blue,:dash), label=\"{x : y[1]=A[1,:] x}\")\nplot!(x1, (y[2] .- A[2,1]*x1)/A[2,2], line=(:green,:dash), label=\"{x : y[2]=A[2,:] x}\")\nscatter!([1], [1], color=:blue, markershape=:star5, label=\"[1,1]\")\nscatter!([xh2[1]], [xh2[2]], color=:red, markershape=:circle, label=\"MNLS\",\n title = \"Singular case\")","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-cost1/#Square-non-singular-case","page":"LS cost functions","title":"Square non-singular case","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"A = [1 2; 1 3] # 3rd case: M = N with non-singular A\ny = [3, 4] # now x=[1,1] is the unique solution (by design)\nf3(x) = norm(A*x - y)\nxh3 = A \\ y\n\nc3 = [f3([x1a, x2a]) for x1a=x1, x2a=x2]\ncontour(x1, x2, c3', label=\"contours\"; color)\nplot!(aspect_ratio=:equal, xlabel=L\"x_1\", ylabel=L\"x_2\", legend=:bottomleft)\nplot!(x1, (y[1] .- A[1,1]*x1)/A[1,2], line=(:blue,:dash), label=\"{x : y[1]=A[1,:] x}\")\nplot!(x1, (y[2] .- A[2,1]*x1)/A[2,2], line=(:green,:dash), label=\"{x : y[2]=A[2,:] x}\")\nscatter!([xh3[1]], [xh3[2]], color=:red, markershape=:circle, label=\"LLS\",\n title = \"Non-singular case\")","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-cost1/#Typical-over-determined-case","page":"LS cost functions","title":"Typical over-determined case","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"A = [1 2; 1 -1; 2 1] # 4th case: M > N with (typical) inconsistent data\ny = [3, 2, 1] # no consistent solution\nf4(x) = norm(A*x - y)\nxh4 = A \\ y\n\nc4 = [f4([x1a, x2a]) for x1a=x1, x2a=x2]\ncontour(x1, x2, c4', label=\"contours\"; color)\nplot!(aspect_ratio=:equal, xlabel=L\"x_1\", ylabel=L\"x_2\", legend=:bottomleft)\nplot!(x1, (y[1] .- A[1,1]*x1)/A[1,2], line=(:blue,:dash), label=\"{x : y[1]=A[1,:] x}\")\nplot!(x1, (y[2] .- A[2,1]*x1)/A[2,2], line=(:green,:dash), label=\"{x : y[2]=A[2,:] x}\")\nplot!(x1, (y[3] .- A[3,1]*x1)/A[3,2], line=(:purple,:dash), label=\"{x : y[3]=A[3,:] x}\")\nplot!(xlim=(-3,3), ylim=(-3,3))\nscatter!([xh4[1]], [xh4[2]], color=:red, markershape=:circle, label=\"LLS\",\n title = \"Over-determined case\")","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"prompt()","category":"page"},{"location":"generated/demos/04/ls-cost1/#Reproducibility","page":"LS cost functions","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"And with the following package versions","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"","category":"page"},{"location":"generated/demos/04/ls-cost1/","page":"LS cost functions","title":"LS cost functions","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#Demos-for-Book","page":"Home","title":"Demos for Book","text":"","category":"section"},{"location":"#Overview","page":"Home","title":"Overview","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"https://github.com/JeffFessler/book-mmaj-demo","category":"page"},{"location":"","page":"Home","title":"Home","text":"Demos in the Julia language, compiled using Literate and Documenter to accompany the book \"Matrix Methods and Applications in Julia\" by Jeff Fessler and Raj Nadakuditi at the University of Michigan.","category":"page"},{"location":"#Getting-started-with-Julia","page":"Home","title":"Getting started with Julia","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Install Julia from https://julialang.org\nLaunch the Julia app should open a Julia REPL.\nTo develop code, select an editor, preferably with Julia integration, such as VSCode or vim perhaps with tmux. Appropriate editor plug-ins are needed to use LaTeX-like tab-completion of unicode characters like ÷ ⊗ ⊕ ∘ × and α β γ.\nPeruse the demos listed in the menu here. If your browser window is wide enough, you should see a menu to the left. If your window is narrow, you should see a hamburger menu button that will toggle open the demos menu sidebar.\nView the excellent documentation at JuliaImages\nCheck out some Julia tutorials, especially the one titled \"Just the Julia you need to get started in Data Science and ML\" by Raj Rao.","category":"page"},{"location":"#Getting-started-with-Julia-for-matrix-methods","page":"Home","title":"Getting started with Julia for matrix methods","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"These examples show you Julia code and the corresponding output in an HTML format suitable for viewing in a web browser without installing any software.","category":"page"},{"location":"","page":"Home","title":"Home","text":"You could cut and paste portions of that Julia code into the Julia REPL, but that becomes tedious. Instead, click on the \"Edit on GitHub\" link (in the upper right, with github icon), where you can then download the entire Julia code file that generated any of these examples.","category":"page"},{"location":"","page":"Home","title":"Home","text":"For example, the code for the SVD demo is at this url. After downloading such a file such as svd-demo.jl, you can run it by typing include(\"svd-demo.jl\") at the Julia REPL.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"EditURL = \"https://github.com/JeffFessler/book-mmaj-demo/blob/main/docs/lit/demos/docs/lit/demos/05/procrustes.jl\"","category":"page"},{"location":"generated/demos/05/procrustes/#procrustes","page":"Procrustes","title":"Procrustes","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"This example illustrates the Procrustes method using the Julia language.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"This entire page was generated using a single Julia file: procrustes.jl. In any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"The corresponding notebook can be viewed in nbviewer here: procrustes.ipynb, and opened in binder here: procrustes.ipynb,","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"First we add the Julia packages that are need for this demo. Change false to true in the following code block if you are using any of the following packages for the first time.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"if false\n    import Pkg\n    Pkg.add([\n        \"LinearAlgebra\"\n        \"InteractiveUtils\"\n    ])\nend","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"Now tell this Julia session to use the following packages for this example. Run Pkg.add() in the preceding code block first, if needed.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"using LinearAlgebra: svd, norm, Diagonal\nusing MIRTjim: prompt\nusing InteractiveUtils: versioninfo","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"The following line is helpful when running this jl-file as a script; this way it will prompt user to hit a key after each image is displayed.","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"isinteractive() && prompt(:prompt);\nnothing #hide","category":"page"},{"location":"generated/demos/05/procrustes/#Coordinate-data","page":"Procrustes","title":"Coordinate data","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"coordinates from rotated image example in n-05-norm/fig/","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"A = [-59 -25 49;\n    6 -33 20]\nB = [-54.1 -5.15 32.44;\n    -24.3 -41.08 41.82]","category":"page"},{"location":"generated/demos/05/procrustes/#Procrustes-solution-steps","page":"Procrustes","title":"Procrustes solution steps","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"C = B * A'","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"(U,s,V) = svd(C)\ns","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"Q = U * V'","category":"page"},{"location":"generated/demos/05/procrustes/#Fitting-residual","page":"Procrustes","title":"Fitting residual","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"residual = B - Q * A # small!","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"Rotation angle in degrees:","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"acos(Q[1]) * (180/π) # very close to 30° as expected","category":"page"},{"location":"generated/demos/05/procrustes/#Fitting-function","page":"Procrustes","title":"Fitting function","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"function procrustes(A, B)\n    C = B * A'\n    (U,s,V) = svd(C)\n    Q = U*V'\n    scale = sum(s) / norm(A,2)^2\n    return Q, scale\nend","category":"page"},{"location":"generated/demos/05/procrustes/#Explore-additional-special-cases","page":"Procrustes","title":"Explore additional special cases","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"three points along a line, symmetrical","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"A = [-1 0 1; 0 0 0]\nB = [0 0 0; -2 0 2]\nQ, scale = procrustes(A, B)","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"check","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"@assert B ≈ scale * Q * A","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"three points along a line, not symmetrical","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"A = [-1 0 2; 0 0 0]\nB = [0 0 0; -2 0 4]\nQ, scale = procrustes(A, B)","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"check","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"@assert B ≈ scale * Q * A","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"a single point - works fine!","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"A = [1; 0]\nB = [1; 1]\nQ, scale = procrustes(A, B)","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"check","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"@assert B ≈ scale * Q * A","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"angle","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"acos(Q[1]) * 180/π","category":"page"},{"location":"generated/demos/05/procrustes/#Reproducibility","page":"Procrustes","title":"Reproducibility","text":"","category":"section"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"This page was generated with the following version of Julia:","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"io = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"And with the following package versions","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"import Pkg; Pkg.status()","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"","category":"page"},{"location":"generated/demos/05/procrustes/","page":"Procrustes","title":"Procrustes","text":"This page was generated using Literate.jl.","category":"page"}]
}
